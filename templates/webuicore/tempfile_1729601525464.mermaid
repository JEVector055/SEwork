graph TD
    A[主流程] --> B[打印提示符]
    B --> C[读取用户输入]
    C --> D{存在管道符?}
    D -->|是| E[分割输入为两个命令]
    E --> F[分割第一个命令参数]
    F --> G[分割第二个命令参数]
    G --> H[执行管道命令]
    D -->|否| I[分割命令参数]
    I --> J[执行命令]

    H --> K[创建管道]
    K --> L{创建管道失败?}
    L -->|是| M[打印错误信息]
    L -->|否| N[创建第一个子进程]
    N --> O{创建子进程失败?}
    O -->|是| P[打印错误信息]
    O -->|否| Q[重定向标准输出]
    Q --> R[关闭未使用端口]
    R --> S[执行第一个命令]
    S --> T{执行失败?}
    T -->|是| U[退出子进程]
    T -->|否| V[创建第二个子进程]
    V --> W{创建子进程失败?}
    W -->|是| X[打印错误信息]
    W -->|否| Y[重定向标准输入]
    Y --> Z[关闭未使用端口]
    Z --> AA[执行第二个命令]
    AA --> AB{执行失败?}
    AB -->|是| AC[退出子进程]
    AB -->|否| AD[关闭父进程管道端口]
    AD --> AE[等待两个子进程结束]

    J --> AF[创建子进程]
    AF --> AG{创建子进程失败?}
    AG -->|是| AH[打印错误信息]
    AG -->|否| AI[执行命令]
    AI --> AJ{执行失败?}
    AJ -->|是| AK[打印错误信息]
    AJ -->|否| AL[等待子进程结束]
